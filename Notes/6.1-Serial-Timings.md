### 1200
```
$ ./cnn-cifar10
Serial Code
CNN for 1200 images
Loading input batch 1...
Load Data time:0.026121 seconds
Create Network time:0.000011 seconds
Load Network Parameters time:0.008300 seconds
Create Ouputs time:0.000045 seconds

Net Forward total time:36.961910 seconds
    Time for conv1: 11.898314 seconds
    Time for relu1: 0.106129 seconds
    Time for pool1: 0.148784 seconds
    Time for conv2: 19.125811 seconds
    Time for relu2: 0.030581 seconds
    Time for pool2: 0.045081 seconds
    Time for conv3: 5.555799 seconds
    Time for relu3: 0.008876 seconds
    Time for pool3: 0.013067 seconds
    Time for fc: 0.013993 seconds
    Time for softmax: 0.001692 seconds

  Conv: 36.579924 seconds
  ReLU: 0.145586 seconds
  Pool: 0.206932 seconds
  FC:   0.013993 seconds
  Softmax: 0.001692 seconds

Net Accuracy: 78.25 % 
Net Accuracy time:0.000105 seconds
Free memory time:0.001436 seconds
Total time:36.997928 seconds
END!
```

### 13400
```
$ ./cnn-cifar10
Serial Code
CNN for 13400 images
Loading input batch 1...
Loading input batch 2...
Load Data time:0.255686 seconds
Create Network time:0.000012 seconds
Load Network Parameters time:0.008067 seconds
Create Ouputs time:0.000170 seconds

Net Forward total time:424.840853 seconds
    Time for conv1: 136.926588 seconds
    Time for relu1: 1.214971 seconds
    Time for pool1: 1.697389 seconds
    Time for conv2: 219.527978 seconds
    Time for relu2: 0.353346 seconds
    Time for pool2: 0.519897 seconds
    Time for conv3: 64.006567 seconds
    Time for relu3: 0.103321 seconds
    Time for pool3: 0.150651 seconds
    Time for fc: 0.160907 seconds
    Time for softmax: 0.019369 seconds

  Conv: 420.461133 seconds
  ReLU: 1.671638 seconds
  Pool: 2.367937 seconds
  FC:   0.160907 seconds
  Softmax: 0.019369 seconds

Net Accuracy: 78.71 % 
Net Accuracy time:0.001007 seconds
Free memory time:0.015531 seconds
Total time:425.121326 seconds
END!
```
### 25600
```
$ ./cnn-cifar10
Serial Code
CNN for 25600 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Load Data time:0.556425 seconds
Create Network time:0.000013 seconds
Load Network Parameters time:0.008383 seconds
Create Ouputs time:0.000253 seconds

Net Forward total time:829.744195 seconds
    Time for conv1: 263.455649 seconds
    Time for relu1: 2.341174 seconds
    Time for pool1: 3.272245 seconds
    Time for conv2: 422.714944 seconds
    Time for relu2: 0.677066 seconds
    Time for pool2: 0.999888 seconds
    Time for conv3: 135.141108 seconds
    Time for relu3: 0.197380 seconds
    Time for pool3: 0.289913 seconds
    Time for fc: 0.309494 seconds
    Time for softmax: 0.036631 seconds

  Conv: 821.311701 seconds
  ReLU: 3.215620 seconds
  Pool: 4.562046 seconds
  FC:   0.309494 seconds
  Softmax: 0.036631 seconds

Net Accuracy: 78.67 % 
Net Accuracy time:0.002267 seconds
Free memory time:0.031564 seconds
Total time:830.343100 seconds
END!
```

### 37800
```
$ ./cnn-cifar10
Serial Code
CNN for 37800 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Load Data time:0.713218 seconds
Create Network time:0.000029 seconds
Load Network Parameters time:0.008317 seconds
Create Ouputs time:0.000344 seconds

Net Forward total time:1188.364496 seconds
    Time for conv1: 383.049704 seconds
    Time for relu1: 3.408210 seconds
    Time for pool1: 4.756963 seconds
    Time for conv2: 614.281760 seconds
    Time for relu2: 0.984848 seconds
    Time for pool2: 1.452464 seconds
    Time for conv3: 178.772402 seconds
    Time for relu3: 0.286857 seconds
    Time for pool3: 0.421673 seconds
    Time for fc: 0.450496 seconds
    Time for softmax: 0.053752 seconds

  Conv: 1176.103866 seconds
  ReLU: 4.679915 seconds
  Pool: 6.631100 seconds
  FC:   0.450496 seconds
  Softmax: 0.053752 seconds

Net Accuracy: 78.76 % 
Net Accuracy time:0.002934 seconds
Free memory time:0.044466 seconds
Total time:1189.133804 seconds
END!
```

# 50.000 images
```
$ ./cnn-cifar10-serial-50000 
Serial Code
CNN for 50000 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Loading input batch 5...
Load Data time:0.994824 seconds
Create Network time:0.000018 seconds
Load Network Parameters time:0.008645 seconds
Create Ouputs time:0.000443 seconds

Net Forward total time:1575.735180 seconds
    Time for conv1: 524.137613 seconds
    Time for relu1: 4.386128 seconds
    Time for pool1: 6.155470 seconds
    Time for conv2: 802.578278 seconds
    Time for relu2: 1.234625 seconds
    Time for pool2: 1.845802 seconds
    Time for conv3: 233.980326 seconds
    Time for relu3: 0.325806 seconds
    Time for pool3: 0.505723 seconds
    Time for fc: 0.540173 seconds
    Time for softmax: 0.022933 seconds

  Conv: 1560.696218 seconds
  ReLU: 5.946559 seconds
  Pool: 8.506995 seconds
  FC:   0.540173 seconds
  Softmax: 0.022933 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.003480 seconds
Free memory time:0.059575 seconds
Total time:1576.802165 seconds
END!
```
# Profiling

```
$ make profile 
nvc -Minfo=all -c11 -Wall -Wextra -march=native -pg -c main_serial.c -o main_serial.o
nvc -Minfo=all -c11 -Wall -Wextra -march=native -pg -c layers_serial.c -o layers_serial.o
conv_forward:
     62, FMA (fused multiply-add) instruction(s) generated
fc_forward:
    201, FMA (fused multiply-add) instruction(s) generated
nvc -Minfo=all -c11 -Wall -Wextra -march=native -pg -c malloc2D.c -o malloc2D.o
nvc -Minfo=all -c11 -Wall -Wextra -march=native -pg -c timer.c -o timer.o
cpu_timer_stop:
     11, FMA (fused multiply-add) instruction(s) generated
nvc -Minfo=all -c11 -Wall -Wextra -march=native -pg -o cnn-cifar10-serial-profile main_serial.o layers_serial.o malloc2D.o timer.o

$ ./cnn-cifar10-serial-profile 
Serial Code
CNN for 50000 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Loading input batch 5...
Load Data time:0.965365 seconds
Create Network time:0.000011 seconds
Load Network Parameters time:0.008384 seconds
Create Ouputs time:0.000453 seconds

Net Forward total time:1522.332360 seconds
    Time for conv1: 491.547240 seconds
    Time for relu1: 4.164806 seconds
    Time for pool1: 6.003859 seconds
    Time for conv2: 787.232773 seconds
    Time for relu2: 1.190991 seconds
    Time for pool2: 1.803548 seconds
    Time for conv3: 228.990975 seconds
    Time for relu3: 0.320252 seconds
    Time for pool3: 0.492609 seconds
    Time for fc: 0.528956 seconds
    Time for softmax: 0.025174 seconds

  Conv: 1507.770987 seconds
  ReLU: 5.676048 seconds
  Pool: 8.300016 seconds
  FC:   0.528956 seconds
  Softmax: 0.025174 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.011870 seconds
Free memory time:0.062000 seconds
Total time:1523.380443 seconds
END!

```

## Gprof
```
$ gprof ./cnn-cifar10-serial-profile -b
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total           
 time   seconds   seconds    calls  ms/call  ms/call  name    
 99.14   1510.08  1510.08   150000    10.07    10.07  conv_forward
  0.52   1518.00     7.92   150000     0.05     0.05  pool_forward
  0.37   1523.62     5.62   150000     0.04     0.04  relu_forward
  0.06   1524.52     0.90        1   901.09   901.09  load_data
  0.03   1524.94     0.42    50000     0.01     0.01  fc_forward
  0.00   1524.96     0.02                             main
  0.00   1524.97     0.01    50000     0.00     0.00  softmax_forward
  0.00   1524.97     0.00   550007     0.00     0.00  cpu_timer_start
  0.00   1524.97     0.00   550007     0.00     0.00  cpu_timer_stop
  0.00   1524.97     0.00        3     0.00     0.00  free_conv
  0.00   1524.97     0.00        3     0.00     0.00  free_pool
  0.00   1524.97     0.00        3     0.00     0.00  free_relu
  0.00   1524.97     0.00        3     0.00     0.00  load_conv
  0.00   1524.97     0.00        3     0.00     0.00  make_conv_layer
  0.00   1524.97     0.00        3     0.00     0.00  make_pool_layer
  0.00   1524.97     0.00        3     0.00     0.00  make_relu_layer
  0.00   1524.97     0.00        2     0.00     0.00  malloc2D
  0.00   1524.97     0.00        1     0.00     0.00  arr2txt_2
  0.00   1524.97     0.00        1     0.00     0.00  free_fc
  0.00   1524.97     0.00        1     0.00     0.00  free_softmax
  0.00   1524.97     0.00        1     0.00     0.00  load_fc
  0.00   1524.97     0.00        1     0.00     0.00  make_fc_layer
  0.00   1524.97     0.00        1     0.00     0.00  make_softmax_layer


                        Call graph


granularity: each sample hit covers 2 byte(s) for 0.00% of 1524.97 seconds

index % time    self  children    called     name
                                                 <spontaneous>
[1]    100.0    0.02 1524.95                 main [1]
             1510.08    0.00  150000/150000      conv_forward [2]
                7.92    0.00  150000/150000      pool_forward [3]
                5.62    0.00  150000/150000      relu_forward [4]
                0.90    0.00       1/1           load_data [5]
                0.42    0.00   50000/50000       fc_forward [6]
                0.01    0.00   50000/50000       softmax_forward [7]
                0.00    0.00  550007/550007      cpu_timer_start [8]
                0.00    0.00  550007/550007      cpu_timer_stop [9]
                0.00    0.00       3/3           make_conv_layer [14]
                0.00    0.00       3/3           make_relu_layer [16]
                0.00    0.00       3/3           make_pool_layer [15]
                0.00    0.00       3/3           load_conv [13]
                0.00    0.00       3/3           free_pool [11]
                0.00    0.00       3/3           free_conv [10]
                0.00    0.00       3/3           free_relu [12]
                0.00    0.00       2/2           malloc2D [17]
                0.00    0.00       1/1           make_fc_layer [22]
                0.00    0.00       1/1           make_softmax_layer [23]
                0.00    0.00       1/1           load_fc [21]
                0.00    0.00       1/1           arr2txt_2 [18]
                0.00    0.00       1/1           free_fc [19]
                0.00    0.00       1/1           free_softmax [20]
-----------------------------------------------
             1510.08    0.00  150000/150000      main [1]
[2]     99.0 1510.08    0.00  150000         conv_forward [2]
-----------------------------------------------
                7.92    0.00  150000/150000      main [1]
[3]      0.5    7.92    0.00  150000         pool_forward [3]
-----------------------------------------------
                5.62    0.00  150000/150000      main [1]
[4]      0.4    5.62    0.00  150000         relu_forward [4]
-----------------------------------------------
                0.90    0.00       1/1           main [1]
[5]      0.1    0.90    0.00       1         load_data [5]
-----------------------------------------------
                0.42    0.00   50000/50000       main [1]
[6]      0.0    0.42    0.00   50000         fc_forward [6]
-----------------------------------------------
                0.01    0.00   50000/50000       main [1]
[7]      0.0    0.01    0.00   50000         softmax_forward [7]
-----------------------------------------------
                0.00    0.00  550007/550007      main [1]
[8]      0.0    0.00    0.00  550007         cpu_timer_start [8]
-----------------------------------------------
                0.00    0.00  550007/550007      main [1]
[9]      0.0    0.00    0.00  550007         cpu_timer_stop [9]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[10]     0.0    0.00    0.00       3         free_conv [10]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[11]     0.0    0.00    0.00       3         free_pool [11]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[12]     0.0    0.00    0.00       3         free_relu [12]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[13]     0.0    0.00    0.00       3         load_conv [13]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[14]     0.0    0.00    0.00       3         make_conv_layer [14]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[15]     0.0    0.00    0.00       3         make_pool_layer [15]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[16]     0.0    0.00    0.00       3         make_relu_layer [16]
-----------------------------------------------
                0.00    0.00       2/2           main [1]
[17]     0.0    0.00    0.00       2         malloc2D [17]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[18]     0.0    0.00    0.00       1         arr2txt_2 [18]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[19]     0.0    0.00    0.00       1         free_fc [19]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[20]     0.0    0.00    0.00       1         free_softmax [20]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[21]     0.0    0.00    0.00       1         load_fc [21]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[22]     0.0    0.00    0.00       1         make_fc_layer [22]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[23]     0.0    0.00    0.00       1         make_softmax_layer [23]
-----------------------------------------------


Index by function name

  [18] arr2txt_2              [12] free_relu              [15] make_pool_layer
   [2] conv_forward           [20] free_softmax           [16] make_relu_layer
   [8] cpu_timer_start        [13] load_conv              [23] make_softmax_layer
   [9] cpu_timer_stop          [5] load_data              [17] malloc2D
   [6] fc_forward             [21] load_fc                 [3] pool_forward
  [10] free_conv               [1] main                    [4] relu_forward
  [19] free_fc                [14] make_conv_layer         [7] softmax_forward
  [11] free_pool              [22] make_fc_layer
  ```
---
# Profile

## 1200
```
$ ./cnn-cifar10-serial
Serial Code
CNN for 1200 images
Loading input batch 1...
Load Data time:0.028839 seconds
Create Network time:0.000029 seconds
Load Network Parameters time:0.008346 seconds
Create Ouputs time:0.000047 seconds

Net Forward total time:37.396562 seconds
    Time for conv1: 12.066903 seconds
    Time for relu1: 0.102435 seconds
    Time for pool1: 0.147990 seconds
    Time for conv2: 19.346542 seconds
    Time for relu2: 0.029167 seconds
    Time for pool2: 0.044388 seconds
    Time for conv3: 5.624670 seconds
    Time for relu3: 0.007901 seconds
    Time for pool3: 0.012163 seconds
    Time for fc: 0.013078 seconds
    Time for softmax: 0.000595 seconds

  Conv: 37.038115 seconds
  ReLU: 0.139503 seconds
  Pool: 0.204541 seconds
  FC:   0.013078 seconds
  Softmax: 0.000595 seconds

Net Accuracy: 78.25 % 
Net Accuracy time:0.000084 seconds
Free memory time:0.001688 seconds
Total time:37.435595 seconds
END!
```

```
$ ./cnn-cifar10-serial-profile 
Serial Code
CNN for 1200 images
Loading input batch 1...
Load Data time:0.026320 seconds
Create Network time:0.000010 seconds
Load Network Parameters time:0.008364 seconds
Create Ouputs time:0.000045 seconds

Net Forward total time:37.411331 seconds
    Time for conv1: 12.087406 seconds
    Time for relu1: 0.102676 seconds
    Time for pool1: 0.147422 seconds
    Time for conv2: 19.347375 seconds
    Time for relu2: 0.029384 seconds
    Time for pool2: 0.044107 seconds
    Time for conv3: 5.618572 seconds
    Time for relu3: 0.007827 seconds
    Time for pool3: 0.012220 seconds
    Time for fc: 0.012973 seconds
    Time for softmax: 0.000603 seconds

  Conv: 37.053354 seconds
  ReLU: 0.139887 seconds
  Pool: 0.203749 seconds
  FC:   0.012973 seconds
  Softmax: 0.000603 seconds

Net Accuracy: 78.25 % 
Net Accuracy time:0.000091 seconds
Free memory time:0.001732 seconds
Total time:37.447893 seconds
END!

olia@krylov100:~/Diplomatiki/cnn-cifar10_0/serial_code$ gprof ./cnn-cifar10-serial-profile -b
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total           
 time   seconds   seconds    calls  ms/call  ms/call  name    
 99.21     37.13    37.13     3600    10.31    10.31  conv_forward
  0.43     37.29     0.16     3600     0.04     0.04  relu_forward
  0.40     37.44     0.15     3600     0.04     0.04  pool_forward
  0.05     37.46     0.02        1    20.02    20.02  load_data
  0.03     37.47     0.01     1200     0.01     0.01  fc_forward
  0.00     37.47     0.00    13207     0.00     0.00  cpu_timer_start
  0.00     37.47     0.00    13207     0.00     0.00  cpu_timer_stop
  0.00     37.47     0.00     1200     0.00     0.00  softmax_forward
  0.00     37.47     0.00        3     0.00     0.00  free_conv
  0.00     37.47     0.00        3     0.00     0.00  free_pool
  0.00     37.47     0.00        3     0.00     0.00  free_relu
  0.00     37.47     0.00        3     0.00     0.00  load_conv
  0.00     37.47     0.00        3     0.00     0.00  make_conv_layer
  0.00     37.47     0.00        3     0.00     0.00  make_pool_layer
  0.00     37.47     0.00        3     0.00     0.00  make_relu_layer
  0.00     37.47     0.00        2     0.00     0.00  malloc2D
  0.00     37.47     0.00        1     0.00     0.00  arr2txt_2
  0.00     37.47     0.00        1     0.00     0.00  free_fc
  0.00     37.47     0.00        1     0.00     0.00  free_softmax
  0.00     37.47     0.00        1     0.00     0.00  load_fc
  0.00     37.47     0.00        1     0.00     0.00  make_fc_layer
  0.00     37.47     0.00        1     0.00     0.00  make_softmax_layer


                        Call graph


granularity: each sample hit covers 2 byte(s) for 0.03% of 37.47 seconds

index % time    self  children    called     name
                                                 <spontaneous>
[1]    100.0    0.00   37.47                 main [1]
               37.13    0.00    3600/3600        conv_forward [2]
                0.16    0.00    3600/3600        relu_forward [3]
                0.15    0.00    3600/3600        pool_forward [4]
                0.02    0.00       1/1           load_data [5]
                0.01    0.00    1200/1200        fc_forward [6]
                0.00    0.00   13207/13207       cpu_timer_start [7]
                0.00    0.00   13207/13207       cpu_timer_stop [8]
                0.00    0.00    1200/1200        softmax_forward [9]
                0.00    0.00       3/3           make_conv_layer [14]
                0.00    0.00       3/3           make_relu_layer [16]
                0.00    0.00       3/3           make_pool_layer [15]
                0.00    0.00       3/3           load_conv [13]
                0.00    0.00       3/3           free_pool [11]
                0.00    0.00       3/3           free_conv [10]
                0.00    0.00       3/3           free_relu [12]
                0.00    0.00       2/2           malloc2D [17]
                0.00    0.00       1/1           make_fc_layer [22]
                0.00    0.00       1/1           make_softmax_layer [23]
                0.00    0.00       1/1           load_fc [21]
                0.00    0.00       1/1           arr2txt_2 [18]
                0.00    0.00       1/1           free_fc [19]
                0.00    0.00       1/1           free_softmax [20]
-----------------------------------------------
               37.13    0.00    3600/3600        main [1]
[2]     99.1   37.13    0.00    3600         conv_forward [2]
-----------------------------------------------
                0.16    0.00    3600/3600        main [1]
[3]      0.4    0.16    0.00    3600         relu_forward [3]
-----------------------------------------------
                0.15    0.00    3600/3600        main [1]
[4]      0.4    0.15    0.00    3600         pool_forward [4]
-----------------------------------------------
                0.02    0.00       1/1           main [1]
[5]      0.1    0.02    0.00       1         load_data [5]
-----------------------------------------------
                0.01    0.00    1200/1200        main [1]
[6]      0.0    0.01    0.00    1200         fc_forward [6]
-----------------------------------------------
                0.00    0.00   13207/13207       main [1]
[7]      0.0    0.00    0.00   13207         cpu_timer_start [7]
-----------------------------------------------
                0.00    0.00   13207/13207       main [1]
[8]      0.0    0.00    0.00   13207         cpu_timer_stop [8]
-----------------------------------------------
                0.00    0.00    1200/1200        main [1]
[9]      0.0    0.00    0.00    1200         softmax_forward [9]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[10]     0.0    0.00    0.00       3         free_conv [10]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[11]     0.0    0.00    0.00       3         free_pool [11]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[12]     0.0    0.00    0.00       3         free_relu [12]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[13]     0.0    0.00    0.00       3         load_conv [13]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[14]     0.0    0.00    0.00       3         make_conv_layer [14]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[15]     0.0    0.00    0.00       3         make_pool_layer [15]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[16]     0.0    0.00    0.00       3         make_relu_layer [16]
-----------------------------------------------
                0.00    0.00       2/2           main [1]
[17]     0.0    0.00    0.00       2         malloc2D [17]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[18]     0.0    0.00    0.00       1         arr2txt_2 [18]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[19]     0.0    0.00    0.00       1         free_fc [19]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[20]     0.0    0.00    0.00       1         free_softmax [20]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[21]     0.0    0.00    0.00       1         load_fc [21]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[22]     0.0    0.00    0.00       1         make_fc_layer [22]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[23]     0.0    0.00    0.00       1         make_softmax_layer [23]
-----------------------------------------------


Index by function name

  [18] arr2txt_2              [12] free_relu              [16] make_relu_layer
   [2] conv_forward           [20] free_softmax           [23] make_softmax_layer
   [7] cpu_timer_start        [13] load_conv              [17] malloc2D
   [8] cpu_timer_stop          [5] load_data               [4] pool_forward
   [6] fc_forward             [21] load_fc                 [3] relu_forward
  [10] free_conv              [14] make_conv_layer         [9] softmax_forward
  [19] free_fc                [22] make_fc_layer
  [11] free_pool              [15] make_pool_layer
```

## 50000

```
$ ./cnn-cifar10-serial
Serial Code
CNN for 50000 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Loading input batch 5...
Load Data time:0.963755 seconds
Create Network time:0.000011 seconds
Load Network Parameters time:0.008413 seconds
Create Ouputs time:0.000478 seconds

Net Forward total time:1530.585582 seconds
    Time for conv1: 493.958384 seconds
    Time for relu1: 4.193664 seconds
    Time for pool1: 7.033642 seconds
    Time for conv2: 790.840276 seconds
    Time for relu2: 1.201267 seconds
    Time for pool2: 1.811810 seconds
    Time for conv3: 230.135574 seconds
    Time for relu3: 0.327102 seconds
    Time for pool3: 0.496297 seconds
    Time for fc: 0.533932 seconds
    Time for softmax: 0.024759 seconds

  Conv: 1514.934234 seconds
  ReLU: 5.722033 seconds
  Pool: 9.341748 seconds
  FC:   0.533932 seconds
  Softmax: 0.024759 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.003255 seconds
Free memory time:0.056767 seconds
Total time:1531.618262 seconds
END!
olia@krylov100:~/Diplomatiki/cnn-cifar10_0/serial_code$ gprof -b ./cnn-cifar10-serial-profile 
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total           
 time   seconds   seconds    calls  ms/call  ms/call  name    
 99.10   1515.64  1515.64   150000    10.10    10.10  conv_forward
  0.54   1523.85     8.21   150000     0.05     0.05  pool_forward
  0.39   1529.76     5.91   150000     0.04     0.04  relu_forward
  0.06   1530.65     0.89        1   891.08   891.08  load_data
  0.03   1531.17     0.52    50000     0.01     0.01  fc_forward
  0.00   1531.18     0.01   550007     0.00     0.00  cpu_timer_stop
  0.00   1531.19     0.01                             main
  0.00   1531.19     0.00   550007     0.00     0.00  cpu_timer_start
  0.00   1531.19     0.00    50000     0.00     0.00  softmax_forward
  0.00   1531.19     0.00        3     0.00     0.00  free_conv
  0.00   1531.19     0.00        3     0.00     0.00  free_pool
  0.00   1531.19     0.00        3     0.00     0.00  free_relu
  0.00   1531.19     0.00        3     0.00     0.00  load_conv
  0.00   1531.19     0.00        3     0.00     0.00  make_conv_layer
  0.00   1531.19     0.00        3     0.00     0.00  make_pool_layer
  0.00   1531.19     0.00        3     0.00     0.00  make_relu_layer
  0.00   1531.19     0.00        2     0.00     0.00  malloc2D
  0.00   1531.19     0.00        1     0.00     0.00  free_fc
  0.00   1531.19     0.00        1     0.00     0.00  free_softmax
  0.00   1531.19     0.00        1     0.00     0.00  load_fc
  0.00   1531.19     0.00        1     0.00     0.00  make_fc_layer
  0.00   1531.19     0.00        1     0.00     0.00  make_softmax_layer


                        Call graph


granularity: each sample hit covers 2 byte(s) for 0.00% of 1531.19 seconds

index % time    self  children    called     name
                                                 <spontaneous>
[1]    100.0    0.01 1531.18                 main [1]
             1515.64    0.00  150000/150000      conv_forward [2]
                8.21    0.00  150000/150000      pool_forward [3]
                5.91    0.00  150000/150000      relu_forward [4]
                0.89    0.00       1/1           load_data [5]
                0.52    0.00   50000/50000       fc_forward [6]
                0.01    0.00  550007/550007      cpu_timer_stop [7]
                0.00    0.00  550007/550007      cpu_timer_start [8]
                0.00    0.00   50000/50000       softmax_forward [9]
                0.00    0.00       3/3           make_conv_layer [14]
                0.00    0.00       3/3           make_relu_layer [16]
                0.00    0.00       3/3           make_pool_layer [15]
                0.00    0.00       3/3           load_conv [13]
                0.00    0.00       3/3           free_pool [11]
                0.00    0.00       3/3           free_conv [10]
                0.00    0.00       3/3           free_relu [12]
                0.00    0.00       2/2           malloc2D [17]
                0.00    0.00       1/1           make_fc_layer [21]
                0.00    0.00       1/1           make_softmax_layer [22]
                0.00    0.00       1/1           load_fc [20]
                0.00    0.00       1/1           free_fc [18]
                0.00    0.00       1/1           free_softmax [19]
-----------------------------------------------
             1515.64    0.00  150000/150000      main [1]
[2]     99.0 1515.64    0.00  150000         conv_forward [2]
-----------------------------------------------
                8.21    0.00  150000/150000      main [1]
[3]      0.5    8.21    0.00  150000         pool_forward [3]
-----------------------------------------------
                5.91    0.00  150000/150000      main [1]
[4]      0.4    5.91    0.00  150000         relu_forward [4]
-----------------------------------------------
                0.89    0.00       1/1           main [1]
[5]      0.1    0.89    0.00       1         load_data [5]
-----------------------------------------------
                0.52    0.00   50000/50000       main [1]
[6]      0.0    0.52    0.00   50000         fc_forward [6]
-----------------------------------------------
                0.01    0.00  550007/550007      main [1]
[7]      0.0    0.01    0.00  550007         cpu_timer_stop [7]
-----------------------------------------------
                0.00    0.00  550007/550007      main [1]
[8]      0.0    0.00    0.00  550007         cpu_timer_start [8]
-----------------------------------------------
                0.00    0.00   50000/50000       main [1]
[9]      0.0    0.00    0.00   50000         softmax_forward [9]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[10]     0.0    0.00    0.00       3         free_conv [10]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[11]     0.0    0.00    0.00       3         free_pool [11]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[12]     0.0    0.00    0.00       3         free_relu [12]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[13]     0.0    0.00    0.00       3         load_conv [13]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[14]     0.0    0.00    0.00       3         make_conv_layer [14]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[15]     0.0    0.00    0.00       3         make_pool_layer [15]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[16]     0.0    0.00    0.00       3         make_relu_layer [16]
-----------------------------------------------
                0.00    0.00       2/2           main [1]
[17]     0.0    0.00    0.00       2         malloc2D [17]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[18]     0.0    0.00    0.00       1         free_fc [18]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[19]     0.0    0.00    0.00       1         free_softmax [19]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[20]     0.0    0.00    0.00       1         load_fc [20]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[21]     0.0    0.00    0.00       1         make_fc_layer [21]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[22]     0.0    0.00    0.00       1         make_softmax_layer [22]
-----------------------------------------------


Index by function name

   [2] conv_forward           [19] free_softmax           [16] make_relu_layer
   [8] cpu_timer_start        [13] load_conv              [22] make_softmax_layer
   [7] cpu_timer_stop          [5] load_data              [17] malloc2D
   [6] fc_forward             [20] load_fc                 [3] pool_forward
  [10] free_conv               [1] main                    [4] relu_forward
  [18] free_fc                [14] make_conv_layer         [9] softmax_forward
  [11] free_pool              [21] make_fc_layer
  [12] free_relu              [15] make_pool_layer
```