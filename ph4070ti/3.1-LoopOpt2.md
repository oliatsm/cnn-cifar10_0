# 1. no opt
```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373459 seconds
Create Network time:0.115306 seconds
Load Network Parameters time:0.003348 seconds
Create Ouputs time:0.000173 seconds

Net Forward total time:93.584131 seconds
    Time for conv1: 50.581299 seconds
    Time for relu1: 0.218619 seconds
    Time for pool1: 0.573455 seconds
    Time for conv2: 31.390235 seconds
    Time for relu2: 0.083025 seconds
    Time for pool2: 0.188213 seconds
    Time for conv3: 10.326453 seconds
    Time for relu3: 0.028998 seconds
    Time for pool3: 0.048621 seconds
    Time for fc: 0.123360 seconds
    Time for softmax: 0.006617 seconds

  Conv: 92.297987 seconds
  ReLU: 0.330642 seconds
  Pool: 0.810289 seconds
  FC:   0.123360 seconds
  Softmax: 0.006617 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000260 seconds
Free memory time:0.035651 seconds
Total time:94.112327 seconds
```

# 2. gang, vector (pad_input - no opt)

```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang /* blockIdx.x */
         64, #pragma acc loop seq
         66, #pragma acc loop vector(128) /* threadIdx.x */
     64, Loop is parallelizable
     66, Loop is parallelizable
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang /* blockIdx.x */
         88, #pragma acc loop seq
         90, #pragma acc loop seq
         95, #pragma acc loop vector(128) /* threadIdx.x */
             Generating reduction(+:sum)
         96, #pragma acc loop seq
         97, #pragma acc loop seq
     88, Loop is parallelizable
     90, Loop is parallelizable
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable
    102, FMA (fused multiply-add) instruction(s) generated

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373607 seconds
Create Network time:0.114257 seconds
Load Network Parameters time:0.003353 seconds
Create Ouputs time:0.000171 seconds

Net Forward total time:93.375237 seconds
    Time for conv1: 66.507277 seconds
    Time for relu1: 0.220058 seconds
    Time for pool1: 0.575488 seconds
    Time for conv2: 19.561751 seconds
    Time for relu2: 0.085687 seconds
    Time for pool2: 0.188004 seconds
    Time for conv3: 6.011850 seconds
    Time for relu3: 0.032016 seconds
    Time for pool3: 0.048179 seconds
    Time for fc: 0.123286 seconds
    Time for softmax: 0.006433 seconds

  Conv: 92.080878 seconds
  ReLU: 0.337761 seconds
  Pool: 0.811672 seconds
  FC:   0.123286 seconds
  Softmax: 0.006433 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000250 seconds
Free memory time:0.035609 seconds
Total time:93.902484 seconds
```

> Δεν βελτιώνει και πολύ, η τοποθέτιση του gang και vector με αυτόν τον τρόπο γίνεται αυτόματα

# 3. Gang, worker, vector
```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang /* blockIdx.x */
         64, #pragma acc loop seq
         66, #pragma acc loop vector(128) /* threadIdx.x */
     64, Loop is parallelizable
     66, Loop is parallelizable
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang /* blockIdx.x */
         88, #pragma acc loop worker(4) /* threadIdx.y */
         90, #pragma acc loop seq
         95, #pragma acc loop vector(32) /* threadIdx.x */
             Generating reduction(+:sum)
             Vector barrier inserted to share data across vector lanes
         96, #pragma acc loop seq
         97, #pragma acc loop seq
        104, Vector barrier inserted for vector loop reduction
     88, Loop is parallelizable
     90, Loop is parallelizable
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable
    102, FMA (fused multiply-add) instruction(s) generated

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373822 seconds
Create Network time:0.137164 seconds
Load Network Parameters time:0.003362 seconds
Create Ouputs time:0.000163 seconds

Net Forward total time:29.181123 seconds
    Time for conv1: 17.141433 seconds
    Time for relu1: 0.221514 seconds
    Time for pool1: 0.575442 seconds
    Time for conv2: 7.659002 seconds
    Time for relu2: 0.087548 seconds
    Time for pool2: 0.188470 seconds
    Time for conv3: 3.083077 seconds
    Time for relu3: 0.029726 seconds
    Time for pool3: 0.048482 seconds
    Time for fc: 0.124264 seconds
    Time for softmax: 0.006900 seconds

  Conv: 27.883512 seconds
  ReLU: 0.338788 seconds
  Pool: 0.812393 seconds
  FC:   0.124264 seconds
  Softmax: 0.006900 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000259 seconds
Free memory time:0.035726 seconds
Total time:29.731619 seconds
```

# 4. gang collapse(2), worker, vector
```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang /* blockIdx.x */
         64, #pragma acc loop seq
         66, #pragma acc loop vector(128) /* threadIdx.x */
     64, Loop is parallelizable
     66, Loop is parallelizable
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang collapse(2) /* blockIdx.x */
         88,   /* blockIdx.x collapsed */
         90, #pragma acc loop worker(4) /* threadIdx.y */
         95, #pragma acc loop vector(32) /* threadIdx.x */
             Generating reduction(+:sum)
         96, #pragma acc loop seq
         97, #pragma acc loop seq
        104, Vector barrier inserted for vector loop reduction
     90, Loop is parallelizable
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373263 seconds
Create Network time:0.122609 seconds
Load Network Parameters time:0.003345 seconds
Create Ouputs time:0.000168 seconds

Net Forward total time:8.350628 seconds
    Time for conv1: 3.272769 seconds
    Time for relu1: 0.213894 seconds
    Time for pool1: 0.572105 seconds
    Time for conv2: 2.329204 seconds
    Time for relu2: 0.077713 seconds
    Time for pool2: 0.190316 seconds
    Time for conv3: 1.471679 seconds
    Time for relu3: 0.030745 seconds
    Time for pool3: 0.048077 seconds
    Time for fc: 0.123214 seconds
    Time for softmax: 0.005756 seconds

  Conv: 7.073652 seconds
  ReLU: 0.322352 seconds
  Pool: 0.810498 seconds
  FC:   0.123214 seconds
  Softmax: 0.005756 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000254 seconds
Free memory time:0.036257 seconds
Total time:8.886524 seconds
```

# 5. Gang collapse(2) worker, vector collapse(2)
```
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang collapse(2) /* blockIdx.x */
         88,   /* blockIdx.x collapsed */
         90, #pragma acc loop worker(4) /* threadIdx.y */
         95, #pragma acc loop vector(32) collapse(2) /* threadIdx.x */
             Generating reduction(+:sum)
         96,   /* threadIdx.x collapsed */
         97, #pragma acc loop seq
        104, Vector barrier inserted for vector loop reduction
             Vector barrier inserted due to potential dependence out of a vector loop
     90, Loop is parallelizable
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable
    102, FMA (fused multiply-add) instruction(s) generated

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373842 seconds
Create Network time:0.114301 seconds
Load Network Parameters time:0.003340 seconds
Create Ouputs time:0.000162 seconds

Net Forward total time:7.492127 seconds
    Time for conv1: 2.711180 seconds
    Time for relu1: 0.219353 seconds
    Time for pool1: 0.575178 seconds
    Time for conv2: 2.071048 seconds
    Time for relu2: 0.082001 seconds
    Time for pool2: 0.188745 seconds
    Time for conv3: 1.419818 seconds
    Time for relu3: 0.030672 seconds
    Time for pool3: 0.048942 seconds
    Time for fc: 0.123097 seconds
    Time for softmax: 0.006862 seconds

  Conv: 6.202046 seconds
  ReLU: 0.332025 seconds
  Pool: 0.812865 seconds
  FC:   0.123097 seconds
  Softmax: 0.006862 seconds

Net Accuracy: 13.15 % 
Net Accuracy time:0.000275 seconds
Free memory time:0.034643 seconds
Total time:8.018691 seconds
```

> ΛΑΘΟΣ ΑΠΟΤΕΛΕΣΜΑ.

# 6. gang collapse(2), vector collapse(2)

> αφαιρούμε το worker
```
$ make

conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang collapse(2) /* blockIdx.x */
         88,   /* blockIdx.x collapsed */
         90, #pragma acc loop seq
         95, #pragma acc loop vector(128) collapse(2) /* threadIdx.x */
             Generating reduction(+:sum)
         96,   /* threadIdx.x collapsed */
         97, #pragma acc loop seq
     90, Loop is parallelizable
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable
    102, FMA (fused multiply-add) instruction(s) generated


$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374143 seconds
Create Network time:0.128494 seconds
Load Network Parameters time:0.003412 seconds
Create Ouputs time:0.000170 seconds

Net Forward total time:10.476509 seconds
    Time for conv1: 5.036901 seconds
    Time for relu1: 0.214433 seconds
    Time for pool1: 0.574041 seconds
    Time for conv2: 2.558392 seconds
    Time for relu2: 0.075211 seconds
    Time for pool2: 0.188491 seconds
    Time for conv3: 1.605783 seconds
    Time for relu3: 0.029880 seconds
    Time for pool3: 0.049402 seconds
    Time for fc: 0.123072 seconds
    Time for softmax: 0.005673 seconds

  Conv: 9.201076 seconds
  ReLU: 0.319524 seconds
  Pool: 0.811934 seconds
  FC:   0.123072 seconds
  Softmax: 0.005673 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000264 seconds
Free memory time:0.034771 seconds
Total time:11.017764 seconds
```

> χωρίς το worker το collapse δίνουν σωστά αποτελέσματα


# 7. gang collapse(3), vector collapse(2)

```
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang collapse(3) /* blockIdx.x */
         88,   /* blockIdx.x collapsed */
         90,   /* blockIdx.x collapsed */
         95, #pragma acc loop vector(128) collapse(2) /* threadIdx.x */
             Generating reduction(+:sum)
         96,   /* threadIdx.x collapsed */
         97, #pragma acc loop seq
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable
    102, FMA (fused multiply-add) instruction(s) generated

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374630 seconds
Create Network time:0.119743 seconds
Load Network Parameters time:0.003360 seconds
Create Ouputs time:0.000166 seconds

Net Forward total time:9.537450 seconds
    Time for conv1: 4.350943 seconds
    Time for relu1: 0.219126 seconds
    Time for pool1: 0.573046 seconds
    Time for conv2: 2.442134 seconds
    Time for relu2: 0.073282 seconds
    Time for pool2: 0.187562 seconds
    Time for conv3: 1.468454 seconds
    Time for relu3: 0.030509 seconds
    Time for pool3: 0.048232 seconds
    Time for fc: 0.123385 seconds
    Time for softmax: 0.005555 seconds

  Conv: 8.261530 seconds
  ReLU: 0.322917 seconds
  Pool: 0.808839 seconds
  FC:   0.123385 seconds
  Softmax: 0.005555 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000242 seconds
Free memory time:0.035007 seconds
Total time:10.070598 seconds
```

# 8. gang collapse(3), vector collapse(3)
```
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang collapse(3) /* blockIdx.x */
         88,   /* blockIdx.x collapsed */
         90,   /* blockIdx.x collapsed */
         95, #pragma acc loop vector(128) collapse(3) /* threadIdx.x */
             Generating reduction(+:sum)
         96,   /* threadIdx.x collapsed */
         97,   /* threadIdx.x collapsed */
     95, Loop is parallelizable
     96, Loop is parallelizable
     97, Loop is parallelizable
    102, FMA (fused multiply-add) instruction(s) generated

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373100 seconds
Create Network time:0.116357 seconds
Load Network Parameters time:0.003331 seconds
Create Ouputs time:0.000177 seconds

Net Forward total time:10.517780 seconds
    Time for conv1: 4.639452 seconds
    Time for relu1: 0.220235 seconds
    Time for pool1: 0.574035 seconds
    Time for conv2: 2.958871 seconds
    Time for relu2: 0.081048 seconds
    Time for pool2: 0.189255 seconds
    Time for conv3: 1.634822 seconds
    Time for relu3: 0.027359 seconds
    Time for pool3: 0.048271 seconds
    Time for fc: 0.123434 seconds
    Time for softmax: 0.005539 seconds

  Conv: 9.233146 seconds
  ReLU: 0.328642 seconds
  Pool: 0.811561 seconds
  FC:   0.123434 seconds
  Softmax: 0.005539 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000253 seconds
Free memory time:0.035695 seconds
Total time:11.046693 seconds
```

# 9. gang collapse(3) vector_length(32), vector collapse(2)
```
conv_forward:
     82, Generating present(l[:])
         Generating copyout(Y[:l->out_size]) [if not already present]
         Generating copyin(X[:in_size]) [if not already present]
     83, Generating NVIDIA GPU code
         86, #pragma acc loop gang collapse(3) /* blockIdx.x */
         87,   /* blockIdx.x collapsed */
         88,   /* blockIdx.x collapsed */
         93, #pragma acc loop vector(32) collapse(2) /* threadIdx.x */
             Generating reduction(+:sum)
         94,   /* threadIdx.x collapsed */
         95, #pragma acc loop seq
     93, Loop is parallelizable
     94, Loop is parallelizable
     95, Loop is parallelizable
    100, FMA (fused multiply-add) instruction(s) generated

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.375110 seconds
Create Network time:0.123521 seconds
Load Network Parameters time:0.003342 seconds
Create Ouputs time:0.000169 seconds

Net Forward total time:7.603279 seconds
    Time for conv1: 2.865641 seconds
    Time for relu1: 0.220895 seconds
    Time for pool1: 0.572773 seconds
    Time for conv2: 2.084261 seconds
    Time for relu2: 0.077122 seconds
    Time for pool2: 0.187181 seconds
    Time for conv3: 1.374316 seconds
    Time for relu3: 0.029474 seconds
    Time for pool3: 0.048015 seconds
    Time for fc: 0.122791 seconds
    Time for softmax: 0.005627 seconds

  Conv: 6.324218 seconds
  ReLU: 0.327491 seconds
  Pool: 0.807969 seconds
  FC:   0.122791 seconds
  Softmax: 0.005627 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000259 seconds
Free memory time:0.034749 seconds
Total time:8.140430 seconds
```

# 10. gang collapse(3) vector_length(32), vector collapse(3)
```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374035 seconds
Create Network time:0.121145 seconds
Load Network Parameters time:0.003335 seconds
Create Ouputs time:0.000173 seconds

Net Forward total time:8.375883 seconds
    Time for conv1: 3.064144 seconds
    Time for relu1: 0.222799 seconds
    Time for pool1: 0.574825 seconds
    Time for conv2: 2.498053 seconds
    Time for relu2: 0.084302 seconds
    Time for pool2: 0.188770 seconds
    Time for conv3: 1.521383 seconds
    Time for relu3: 0.029430 seconds
    Time for pool3: 0.048243 seconds
    Time for fc: 0.123206 seconds
    Time for softmax: 0.005512 seconds

  Conv: 7.083581 seconds
  ReLU: 0.336531 seconds
  Pool: 0.811838 seconds
  FC:   0.123206 seconds
  Softmax: 0.005512 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000246 seconds
Free memory time:0.035204 seconds
Total time:8.910020 seconds
```

---

# vector(64)

```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373445 seconds
Create Network time:0.113772 seconds
Load Network Parameters time:0.003348 seconds
Create Ouputs time:0.000170 seconds

Net Forward total time:8.094970 seconds
    Time for conv1: 3.245192 seconds
    Time for relu1: 0.213557 seconds
    Time for pool1: 0.573060 seconds
    Time for conv2: 2.159012 seconds
    Time for relu2: 0.082416 seconds
    Time for pool2: 0.188238 seconds
    Time for conv3: 1.405717 seconds
    Time for relu3: 0.031589 seconds
    Time for pool3: 0.051135 seconds
    Time for fc: 0.123374 seconds
    Time for softmax: 0.006122 seconds

  Conv: 6.809921 seconds
  ReLU: 0.327562 seconds
  Pool: 0.812434 seconds
  FC:   0.123374 seconds
  Softmax: 0.006122 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000259 seconds
Free memory time:0.035211 seconds
Total time:8.621175 seconds
END!
```
# vector(128)
```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373490 seconds
Create Network time:0.135952 seconds
Load Network Parameters time:0.004784 seconds
Create Ouputs time:0.000166 seconds

Net Forward total time:9.538287 seconds
    Time for conv1: 4.352748 seconds
    Time for relu1: 0.218594 seconds
    Time for pool1: 0.577588 seconds
    Time for conv2: 2.439815 seconds
    Time for relu2: 0.074171 seconds
    Time for pool2: 0.187538 seconds
    Time for conv3: 1.465053 seconds
    Time for relu3: 0.028496 seconds
    Time for pool3: 0.048451 seconds
    Time for fc: 0.123438 seconds
    Time for softmax: 0.007141 seconds

  Conv: 8.257616 seconds
  ReLU: 0.321261 seconds
  Pool: 0.813577 seconds
  FC:   0.123438 seconds
  Softmax: 0.007141 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000251 seconds
Free memory time:0.035427 seconds
Total time:10.088358 seconds
END!
```
---

# Pad_input: gang, vector

```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang /* blockIdx.x */
         64, #pragma acc loop seq
         66, #pragma acc loop vector(128) /* threadIdx.x */
     64, Loop is parallelizable
     66, Loop is parallelizable
    
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374307 seconds
Create Network time:0.127894 seconds
Load Network Parameters time:0.003353 seconds
Create Ouputs time:0.000170 seconds

Net Forward total time:7.612897 seconds
    Time for conv1: 2.883381 seconds
    Time for relu1: 0.214994 seconds
    Time for pool1: 0.573029 seconds
    Time for conv2: 2.081607 seconds
    Time for relu2: 0.078245 seconds
    Time for pool2: 0.187932 seconds
    Time for conv3: 1.375476 seconds
    Time for relu3: 0.025407 seconds
    Time for pool3: 0.048162 seconds
    Time for fc: 0.123353 seconds
    Time for softmax: 0.006059 seconds

  Conv: 6.340464 seconds
  ReLU: 0.318646 seconds
  Pool: 0.809123 seconds
  FC:   0.123353 seconds
  Softmax: 0.006059 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000259 seconds
Free memory time:0.035735 seconds
Total time:8.154614 seconds
```

# Pad_input: gang, worker, vector

```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang /* blockIdx.x */
         64, #pragma acc loop worker(4) /* threadIdx.y */
         66, #pragma acc loop vector(32) /* threadIdx.x */
     64, Loop is parallelizable
     66, Loop is parallelizable

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374184 seconds
Create Network time:0.115529 seconds
Load Network Parameters time:0.003340 seconds
Create Ouputs time:0.000166 seconds

Net Forward total time:7.625333 seconds
    Time for conv1: 2.879139 seconds
    Time for relu1: 0.221930 seconds
    Time for pool1: 0.574910 seconds
    Time for conv2: 2.092393 seconds
    Time for relu2: 0.072848 seconds
    Time for pool2: 0.187934 seconds
    Time for conv3: 1.373007 seconds
    Time for relu3: 0.029786 seconds
    Time for pool3: 0.048135 seconds
    Time for fc: 0.123307 seconds
    Time for softmax: 0.006716 seconds

  Conv: 6.344539 seconds
  ReLU: 0.324564 seconds
  Pool: 0.810979 seconds
  FC:   0.123307 seconds
  Softmax: 0.006716 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000264 seconds
Free memory time:0.035339 seconds
Total time:8.154156 seconds
```

# Pad_input: gang collapse(2), vector
!!!

```
pad_input:
     60, Generating present(X[:],l[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang collapse(2) /* blockIdx.x */
         63,   /* blockIdx.x collapsed */
         65, #pragma acc loop vector(128) /* threadIdx.x */
     65, Loop is parallelizable

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374002 seconds
Create Network time:0.123654 seconds
Load Network Parameters time:0.003368 seconds
Create Ouputs time:0.000166 seconds
Failing in Thread:1
call to cuStreamSynchronize returned error 700: Illegal address during kernel execution
```

# pad_input: gang, vector collapse(2)

```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang /* blockIdx.x */
         64, #pragma acc loop vector(128) collapse(2) /* threadIdx.x */
         65,   /* threadIdx.x collapsed */
     64, Loop is parallelizable
     65, Loop is parallelizable
```

```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373936 seconds
Create Network time:0.114518 seconds
Load Network Parameters time:0.003351 seconds
Create Ouputs time:0.000163 seconds

Net Forward total time:7.626712 seconds
    Time for conv1: 2.883964 seconds
    Time for relu1: 0.224780 seconds
    Time for pool1: 0.572869 seconds
    Time for conv2: 2.067785 seconds
    Time for relu2: 0.080589 seconds
    Time for pool2: 0.188016 seconds
    Time for conv3: 1.385443 seconds
    Time for relu3: 0.030370 seconds
    Time for pool3: 0.048718 seconds
    Time for fc: 0.123231 seconds
    Time for softmax: 0.005705 seconds

  Conv: 6.337192 seconds
  ReLU: 0.335739 seconds
  Pool: 0.809604 seconds
  FC:   0.123231 seconds
  Softmax: 0.005705 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000256 seconds
Free memory time:0.034126 seconds
Total time:8.153062 seconds
```

# pad_input: gang vector collapse(3)

```
pad_input:
     60, Generating present(l[:],X[:])
         Generating NVIDIA GPU code
         62, #pragma acc loop gang, vector(128) collapse(3) /* blockIdx.x threadIdx.x */
         63,   /* blockIdx.x threadIdx.x collapsed */
         64,   /* blockIdx.x threadIdx.x collapsed */

$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374070 seconds
Create Network time:0.123143 seconds
Load Network Parameters time:0.003380 seconds
Create Ouputs time:0.000165 seconds

Net Forward total time:7.508536 seconds
    Time for conv1: 2.820630 seconds
    Time for relu1: 0.214524 seconds
    Time for pool1: 0.573245 seconds
    Time for conv2: 2.047228 seconds
    Time for relu2: 0.085147 seconds
    Time for pool2: 0.187599 seconds
    Time for conv3: 1.356466 seconds
    Time for relu3: 0.030821 seconds
    Time for pool3: 0.048227 seconds
    Time for fc: 0.123654 seconds
    Time for softmax: 0.005700 seconds

  Conv: 6.224324 seconds
  ReLU: 0.330492 seconds
  Pool: 0.809071 seconds
  FC:   0.123654 seconds
  Softmax: 0.005700 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000250 seconds
Free memory time:0.035719 seconds
Total time:8.045263 seconds
```

## pad: vector(128)

```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374808 seconds
Create Network time:0.136489 seconds
Load Network Parameters time:0.003353 seconds
Create Ouputs time:0.000163 seconds

Net Forward total time:7.506044 seconds
    Time for conv1: 2.822990 seconds
    Time for relu1: 0.212781 seconds
    Time for pool1: 0.573379 seconds
    Time for conv2: 2.048714 seconds
    Time for relu2: 0.077711 seconds
    Time for pool2: 0.187777 seconds
    Time for conv3: 1.359486 seconds
    Time for relu3: 0.030703 seconds
    Time for pool3: 0.048154 seconds
    Time for fc: 0.123524 seconds
    Time for softmax: 0.005597 seconds

  Conv: 6.231190 seconds
  ReLU: 0.321195 seconds
  Pool: 0.809310 seconds
  FC:   0.123524 seconds
  Softmax: 0.005597 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000248 seconds
Free memory time:0.035270 seconds
Total time:8.056375 seconds

```
## pad: vector(64)
```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.374230 seconds
Create Network time:0.131326 seconds
Load Network Parameters time:0.003355 seconds
Create Ouputs time:0.000173 seconds

Net Forward total time:7.525476 seconds
    Time for conv1: 2.826123 seconds
    Time for relu1: 0.220489 seconds
    Time for pool1: 0.572052 seconds
    Time for conv2: 2.053927 seconds
    Time for relu2: 0.078023 seconds
    Time for pool2: 0.187683 seconds
    Time for conv3: 1.364229 seconds
    Time for relu3: 0.030157 seconds
    Time for pool3: 0.048386 seconds
    Time for fc: 0.123611 seconds
    Time for softmax: 0.005558 seconds

  Conv: 6.244280 seconds
  ReLU: 0.328669 seconds
  Pool: 0.808121 seconds
  FC:   0.123611 seconds
  Softmax: 0.005558 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000262 seconds
Free memory time:0.035789 seconds
Total time:8.070610 seconds
```

## pad: vector(32)

```
$ ./cnn-cifar10 
Parallel (pad) Code
CNN for 50000 images
Load Data time:0.373682 seconds
Create Network time:0.119020 seconds
Load Network Parameters time:0.003380 seconds
Create Ouputs time:0.000162 seconds

Net Forward total time:7.492083 seconds
    Time for conv1: 2.816913 seconds
    Time for relu1: 0.214966 seconds
    Time for pool1: 0.573681 seconds
    Time for conv2: 2.045269 seconds
    Time for relu2: 0.077540 seconds
    Time for pool2: 0.187651 seconds
    Time for conv3: 1.352760 seconds
    Time for relu3: 0.030288 seconds
    Time for pool3: 0.048095 seconds
    Time for fc: 0.123145 seconds
    Time for softmax: 0.006540 seconds

  Conv: 6.214942 seconds
  ReLU: 0.322793 seconds
  Pool: 0.809427 seconds
  FC:   0.123145 seconds
  Softmax: 0.006540 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.000261 seconds
Free memory time:0.035141 seconds
Total time:8.023729 seconds
END!
```
